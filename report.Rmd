---
title: "Analiza glazbenih preferencija i njihovog utjecaja na mentalno zdravlje"
author: "Ena Dvojak, Patrik Blašković, Mislav Hlupić, Eugen Vucelić"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("."))
```

## Uvod

Muzikoterapija je terapijski pristup koji koristi glazbu i njezine elemente za smanjenje stresa, poboljšanje raspoloženja i jačanje mentalnog zdravlja. U tom se procesu koriste različiti glazbeni žanrovi prema preferencijama pojedinca, a glazba služi kao katalizator pozitivnih emocionalnih reakcija.

## Case study: *Muzikoterapija i slušačke navike*

U analizu je uključen skup podataka sa 736 odgovora na anketu koja istražuje slušačke navike, preferirane glazbene žanrove, samoprocijenjeno mentalno zdravlje i druge relevantne čimbenike (dob, odabir streaming servisa, učestalost slušanja određenih žanrova, instrumentalne i skladateljske vještine). Cilj ovog projekta je razumjeti obrasce i povezanosti u podacima te ih statistički interpretirati kako bi se dobio uvid u ulogu glazbe u poticanju pozitivnog mentalnog stanja.

```{r load-libraries, message=FALSE, warning=FALSE}
library(tidyverse) 
library(modeest) 
library(dplyr)
```

```{r source-scripts}
source("R/barplots.R")
```

```{r load-data}
music_data <- read_csv("data/processed/dataset_reduced.csv", show_col_types = FALSE)

head(music_data)
```

## Deskriptivna statistika

### Mjere centralne tendencije

Mjere centralne tendencije za numeričke varijable "Age" i "Hours per day" grupirane po primarnom streaming servisu. Mod je izostavljen zato što nije dobra mjera centralne tendencije za ovaj dataset. Najveća frekvencija sati slušanja i godina ispitanika nije nužno najbolji pokazatelj sredine podataka, pogtovo za streaming servise s manje korisnika.

Koristiti ćemo 10% podrezanu aritmetičku sredinu jer iako su potencijalni ekstremni podaci značajni za analizu navika slušanja glazbe, moramo uzeti u obzir i neozbiljne ispune ankete koje mogu značajno utjecati na sredinu podataka.

```{r central-tendency}
music_data %>%
  group_by(`Primary streaming service`) %>%
  summarise(
    count = n(),
    mean_age = mean(Age, na.rm = TRUE,trim = 0.1),
    median_age = median(Age, na.rm = TRUE),
    mean_hours = mean(`Hours per day`, na.rm = TRUE, trim = 0.1),
    median_hours = median(`Hours per day`, na.rm = TRUE)
  ) %>%
  arrange(desc(count))
```

### Brisanje outliera

Prije računanja mjere rasipanja i vizualizacije box plotom, pokušati ćemo ukloniti outliere iz varijabli "Age" i "Hours per day" zdravim razumom. Naime anketa sadrži podatke o korisnicima koji su upisali nerealne godine ili sate slušanja glazbe. Uzimajući u obzir da jedan dan ima 24 sata i da većina ljudi ne sluša glazbu dok spava, realna maksimalna granica za "Hours per day" je 24 sata - 8 sati sna = 16 sati slušanja dnevno (ovime smo uklonili ukupno 3 data pointa). Za dob ispitanika ćemo uzeti u obzir da stariji generalno nisu skloni ispunjavanju anekta stoga ćemo heuristički staviti maksimalnu granicu za "Age" na 70 godina (ovime smo uklonili ukupno 7 data pointa).

```{r remove-outliers-heuristic}
music_data <- music_data %>%
  filter(`Hours per day` <= 16, Age <= 70)
```

### Mjere rasipanja

Mjere rasipanja za varijable "Age" i "Hours per day" grupirane po primarnom streaming servisu. Pomoću standardne devijacije i ranga donosimo zaključke da Spotify ima najveći rang godina (ima i najviše korisnika među ispitanicima općenito), dok Pandora ima najveću standardnu devijaciju godina među svojim korisnicima (čemu pridonosi činjenica da je Pandora najmanje zastupljena među ispitanicima).

```{r dispersion}
music_data %>%
  group_by(`Primary streaming service`) %>%
  summarise(
    sd_age = sd(Age, na.rm = TRUE),
    range_age = max(Age, na.rm = TRUE) - min(Age, na.rm = TRUE),
    sd_hours = sd(`Hours per day`, na.rm = TRUE),
    range_hours = max(`Hours per day`, na.rm = TRUE) - min(`Hours per day`, na.rm = TRUE)
  ) %>%
  arrange(desc(sd_age))
```

### Vizualizacija box plot

Iz box plotova vizualiziranih ispod možemo zaključiti da mlađi ispitanici preferiraju Spotify, Apple Music i YouTubeMusic dok stariji ispitanici preferiraju Pandoru ili alternativne servise. Spotify ima najaktivnije korisnike s najviše slušanih sati dnevno s najviše ljudi koji premašuju gornje whiskere boxplota. Outlieri prikazani boxplotom su zdravi i razumni podaci.

```{r boxplot1}
music_data %>%
  ggplot(aes(x = `Primary streaming service`, y = Age, fill=`Primary streaming service`)) +
  geom_boxplot() +
  labs(title = "Dob ispitanika po primarnom streaming servisu",
       x = "Primarni streaming servis",
       y = "Dob") + scale_fill_brewer(palette = "Set2")
```

```{r boxplot2}
music_data %>%
  ggplot(aes(x = `Primary streaming service`, y = `Hours per day`, fill=`Primary streaming service`)) +
  geom_boxplot() +
  labs(title = "Sati slušanja dnevno po primarnom streaming servisu",
       x = "Primarni streaming servis",
       y = "Broj sati dnevno") + scale_fill_brewer(palette = "Set2")
```

### Vizualizacija barplot
Barplotom ćemo vizualiraiti neke kategoričke varijable koje će biti od značaja u daljnim analizama. Izabrane kategoričke varijable su "Instrumentalist", "Composer", "Fav genre" i "Exploratory".

```{r barplot_binary}
plot <- create_binary_plots(music_data)
print(plot)

```

```{r barplot_fav_genre}
plot <- create_fav_genre_plot(music_data)
print(plot)
```